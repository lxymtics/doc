import{e as s}from"./app.7d2ff5c0.js";import{_ as n}from"./plugin-vue_export-helper.5a098b48.js";const a={},e=s('<h1 id="变量-函数等" tabindex="-1"><a class="header-anchor" href="#变量-函数等" aria-hidden="true">#</a> 变量，函数等</h1><h2 id="变量" tabindex="-1"><a class="header-anchor" href="#变量" aria-hidden="true">#</a> 变量</h2><p>变量的分类如下, 具体细节之后介绍.</p><h3 id="系统变量" tabindex="-1"><a class="header-anchor" href="#系统变量" aria-hidden="true">#</a> 系统变量</h3><p>系统变量是由系统定义的, 属于服务器层面.</p><p>系统变量中, <strong>全局变量可以跨连接.</strong> 就是说, 假如我将一个全局变量<code>G</code> 的值从<code>1</code> 修改成<code>0</code> 后, 在别的地方连接上数据库时<code>G</code> 的值仍然是<code>0</code> . 但是,**全局变量不能跨重启. **也就是说, 当数据库重启后, <code>G</code> 的值会恢复为其默认值<code>1</code>.</p><hr><p>如何查看系统变量了呢? 看如下几个例子和他们的作用:</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">--查看所有会话变量</span>\n<span class="token keyword">SHOW</span> VARIABLES<span class="token punctuation">;</span>\n<span class="token keyword">SHOW</span> <span class="token keyword">SESSION</span> VARIABLES<span class="token punctuation">;</span>\n<span class="token comment">--查看所有全局变量</span>\n<span class="token keyword">SHOW</span> <span class="token keyword">GLOBAL</span> VARIABLES<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如上面例子中的注释所示, 查看系统变量时, 默认查询的为<code>SESSION</code>, 所以说前两条的作用是相同的, 注意这可能和我们的认知不同(我们可能以为没有限定词的条件下是查询全部的). 我们可以自己在前面加<code>GLOBAL</code> 表示是全局变量.</p><p>如上方式将列出全部的全局或会话变量, 我们可以用如下形式查看满足条件的部分系统变量:</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 例子: 含有&#39;char&#39;的变量</span>\n<span class="token keyword">SHOW</span> <span class="token keyword">SESSION</span> VARIABLES\n<span class="token operator">LIKE</span> <span class="token string">&#39;%char%&#39;</span><span class="token punctuation">;</span>\n\n<span class="token comment">-- 3. 查看指定的某个系统变量</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>我们也可以直接指定需要查询的变量的名称, 如:</p><p><strong>&lt;在这里遇到了一些问题, 比如SHOW的三种方式都可以展示版本, 而SELECT不行, 待修复&gt;</strong></p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 查询数据库的版本(由于这个变量是全局变量, 所以不能用SESSION)</span>\n<span class="token keyword">SELECT</span> @<span class="token variable">@VERSION</span><span class="token punctuation">;</span>\n<span class="token keyword">SELECT</span> @<span class="token variable">@GLOBAL.VERSION</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><hr><p><strong>修改系统变量</strong></p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token keyword">GLOBAL</span> <span class="token punctuation">[</span>系统变量名<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>值<span class="token punctuation">]</span><span class="token punctuation">;</span>\n\n<span class="token keyword">SET</span> <span class="token keyword">SESSION</span> <span class="token punctuation">[</span>系统变量名<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>值<span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">SET</span> <span class="token punctuation">[</span>系统变量名<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>值<span class="token punctuation">]</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>或</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SET</span> @<span class="token variable">@GLOBAL.</span><span class="token punctuation">[</span>系统变量名<span class="token punctuation">]</span> <span class="token operator">=</span> 值<span class="token punctuation">;</span>\n\n<span class="token keyword">SET</span> @<span class="token variable">@SESSION.</span><span class="token punctuation">[</span>系统变量名<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>值<span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">SET</span> @@<span class="token punctuation">[</span>系统变量名<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>值<span class="token punctuation">]</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="自定义变量-用户变量" tabindex="-1"><a class="header-anchor" href="#自定义变量-用户变量" aria-hidden="true">#</a> 自定义变量 用户变量</h3><p>使用自定义变量的步骤:</p><ol><li><p>声明</p></li><li><p>赋值</p></li><li><p>使用(查看, 比较, 运算)</p></li></ol><p>用户变量作用域: 针对于当前会话有效, 同于会话变量的作用域</p><hr><p>声明并初始化有如下三种方式推荐:</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@var_name</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>\n<span class="token keyword">SET</span> <span class="token variable">@var_name</span> :<span class="token operator">=</span> val<span class="token punctuation">;</span>\n<span class="token keyword">SELECT</span> <span class="token variable">@var_name</span> :<span class="token operator">=</span> val<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><hr><p>赋值的方式可以通过上述三种方式, 切这样做可以不管数据的类型, 如:</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@val</span> <span class="token operator">=</span> <span class="token string">&#39;张三&#39;</span><span class="token punctuation">;</span>\n<span class="token keyword">SET</span> <span class="token variable">@val</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>除此之外, 还可以用这样的方式:</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 将学生的数量赋值给count</span>\n<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">INTO</span> <span class="token variable">@count</span>\n<span class="token keyword">FROM</span> student<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><hr><p>查看:</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token variable">@count</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="自定义变量-局部变量" tabindex="-1"><a class="header-anchor" href="#自定义变量-局部变量" aria-hidden="true">#</a> 自定义变量 局部变量</h3><p>作用域：仅仅在定义它的begin 和 end 中有效, 且为第一句</p><hr><p>声明</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> 变量名 类型<span class="token punctuation">;</span>\n<span class="token keyword">DECLARE</span> 变量名 <span class="token keyword">DEFAULT</span> 值<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><hr><p>赋值(除了SELECT外, 不需要@)</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SET</span> var_name <span class="token operator">=</span> val<span class="token punctuation">;</span>\n<span class="token keyword">SET</span> var_name :<span class="token operator">=</span> val<span class="token punctuation">;</span>\n<span class="token keyword">SELECT</span> <span class="token variable">@var_name</span> :<span class="token operator">=</span> val<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>或</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 值 <span class="token keyword">INTO</span> 局部变量名\n<span class="token keyword">FROM</span> 表<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="" tabindex="-1"><a class="header-anchor" href="#" aria-hidden="true">#</a></h2><h2 id="函数" tabindex="-1"><a class="header-anchor" href="#函数" aria-hidden="true">#</a> 函数</h2><p>函数是一组预先编译好的SQL语句集合, 可以提高代码的复用性, 简化操作, 提高效率</p><p>函数只能有一个返回值.</p><h3 id="创建函数" tabindex="-1"><a class="header-anchor" href="#创建函数" aria-hidden="true">#</a> 创建函数</h3><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> 函数名<span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span>\n<span class="token keyword">RETURNS</span> 返回类型\n<span class="token keyword">BEGIN</span>\n\t函数体\n<span class="token keyword">END</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><p>函数体必须要有<code>RETURN</code> 语句, 否则会报错.<code>RETURN</code> 可以不不在函数体的最后一句, 但是不建议这么做</p></li><li><p>函数体如果只有一句, 可以省略<code>BEGIN</code> 和<code>END</code></p></li><li><p>使用<code>DELIMETER</code> 语句设置结束标记</p></li></ul><h3 id="调用函数" tabindex="-1"><a class="header-anchor" href="#调用函数" aria-hidden="true">#</a> 调用函数</h3><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 函数名<span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="查看-删除函数" tabindex="-1"><a class="header-anchor" href="#查看-删除函数" aria-hidden="true">#</a> 查看/删除函数</h3><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 查看</span>\n<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> 函数名称<span class="token punctuation">;</span>\n\n<span class="token comment">-- 删除</span>\n<span class="token keyword">DROP</span> <span class="token keyword">FUNCTION</span> 函数名称<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><hr><p>案例</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 创建一个函数, 可以返回学号对应学生的姓名</span>\n<span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> getInfo<span class="token punctuation">(</span>id <span class="token keyword">INT</span><span class="token punctuation">)</span> <span class="token keyword">RETURNS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>\n<span class="token keyword">BEGIN</span>\n\t<span class="token keyword">DECLARE</span> tmp <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\t<span class="token keyword">SELECT</span> s_name <span class="token keyword">INTO</span> tmp\n\t<span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> s_id <span class="token operator">=</span> id<span class="token punctuation">;</span>\n\t<span class="token keyword">RETURN</span> tmp<span class="token punctuation">;</span>\n<span class="token keyword">END</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="存储过程" tabindex="-1"><a class="header-anchor" href="#存储过程" aria-hidden="true">#</a> 存储过程</h2><p>存储过程相当于将一系列操作封装起来</p><h3 id="创建语法" tabindex="-1"><a class="header-anchor" href="#创建语法" aria-hidden="true">#</a> 创建语法</h3><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> 存储过程名称<span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span>\n<span class="token keyword">BEGIN</span>\n\t存储过程体\n<span class="token keyword">END</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>参数列表包括三个部分:</p><ul><li><p>参数模式</p><ul><li><p>IN: 该参数可以作为输入, 也就是需要调用者传入值</p></li><li><p>OUT: 该参数可以返回值</p></li><li><p>INOUT: 该参数可以传入和返回</p></li></ul></li><li><p>参数名</p></li><li><p>参数类型</p></li></ul><p>如果存储过程体仅有一句话, <code>BEGIN</code> 和<code>END</code> 可以省略</p><p>另外, 在存储过程体中, 由于有很多其他的查询语句, 所以MYSQL不知道哪里是存储过程地结尾, 所以需要用<code>DELIMITER</code> 重新设置(这个过程只能在MySQL的黑窗口使用)</p><h3 id="调用语法" tabindex="-1"><a class="header-anchor" href="#调用语法" aria-hidden="true">#</a> 调用语法</h3><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CALL</span> 存储过程名<span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="流程控制" tabindex="-1"><a class="header-anchor" href="#流程控制" aria-hidden="true">#</a> 流程控制</h2>',70);var p=n(a,[["render",function(s,n){return e}]]);export{p as default};
